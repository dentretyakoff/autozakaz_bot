# üöò Autozakaz - —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç –¥–ª—è –∑–∞–∫–∞–∑–∞ –∞–≤—Ç–æ–∑–∞–ø—á–∞—Å—Ç–µ–π

Autozakaz ‚Äî —ç—Ç–æ Telegram-–±–æ—Ç, —Å –ø–æ–º–æ—â—å—é –∫–æ—Ç–æ—Ä–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –Ω–∞–π—Ç–∏ –∞–≤—Ç–æ–∑–∞–ø—á–∞—Å—Ç–∏ –ø–æ –∫–æ–¥—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è, –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É, –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞, –∞–¥—Ä–µ—Å–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ –æ–ø–ª–∞—Ç–∏—Ç—å –æ–Ω–ª–∞–π–Ω.

### üìã –ù–∞–≤–∏–≥–∞—Ü–∏—è
- [–û–ø–∏—Å–∞–Ω–∏–µ](#description)
- [–°—Ç–µ–∫](#stack)
    - [–ë–æ—Ç](#stack-bot)
    - [–ë—ç–∫–µ–Ω–¥](#stack-backend)
- [–ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞](#start)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx](#nginx-config)
- [–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](#usage)
- [–ê–≤—Ç–æ—Ä—ã](#authors)

### üßæ –û–ø–∏—Å–∞–Ω–∏–µ <a id="description"></a>
- –ü–æ–∏—Å–∫ –¥–µ—Ç–∞–ª–µ–π:
    - –î–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ–∏—Å–∫ –ø–æ –∫–æ–¥—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è –∏–ª–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É –∞—Ä—Ç–∏–∫—É–ª—É.
    - –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –≤ –≤–∏–¥–µ —Å–ø–∏—Å–∫–∞ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞, –Ω–∞–∂–∞–≤ –Ω–∞ –¥–µ—Ç–∞–ª—å –º–æ–∂–Ω–æ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –¥–µ—Ç–∞–ª—è–º–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É.
- –ó–∞–∫–∞–∑—ã:
    - –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º.
- –ö–æ—Ä–∑–∏–Ω–∞:
    - –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ —Ä–∞–Ω–µ–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤.
    - –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑.
    - –ï—Å—Ç—å –∫–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É.
- –ö–æ–Ω—Ç–∞–∫—Ç—ã:
    - –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–æ–Ω—Ç–∞–∫—Ç—ã –º–∞–≥–∞–∑–∏–Ω–∞, –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –±–∞–∫–µ–Ω–¥–∞.


### üõ†Ô∏è –°—Ç–µ–∫ <a id="stack"></a>
#### ü§ñ –ë–æ—Ç (Telegram) <a id="stack-bot"></a>
- aiogram==3.20.0 ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –±–æ—Ç–æ–≤
- celery[redis]==5.5.3 ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø–ª–∞—Ç—ã)
- redis==5.2.1 ‚Äî –±—Ä–æ–∫–µ—Ä –∑–∞–¥–∞—á –∏ –∫–µ—à
- asgiref==3.8.1 ‚Äî –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è async –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- python-dotenv==1.1.0 ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ .env
- psycopg2-binary==2.9.10 ‚Äî –¥—Ä–∞–π–≤–µ—Ä PostgreSQL
- requests==2.32.4 ‚Äî HTTP-–∑–∞–ø—Ä–æ—Å—ã –∫ backend

#### üß© –ë—ç–∫–µ–Ω–¥ (Django) <a id="stack-backend"></a>
- Django==5.2.1 ‚Äî web-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- djangorestframework==3.16.0 ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ API
- celery[redis]==5.5.3 ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤)
- python-dotenv==1.1.0 ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ .env
- psycopg2-binary==2.9.10 ‚Äî PostgreSQL
- pandas>=2.2.3 ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ csv —Ñ–∞–π–ª–æ–≤ —Å —Ç–æ–≤–∞—Ä–∞–º–∏
- django-meili>=0.0.11 ‚Äî –∫–µ—à –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞


### üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞ <a id="start"></a>
- –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
```
git clone git@github.com:dentretyakoff/autozakaz_bot.git
```
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã(docker, nginx, certbot)
```
# Docker install
#!/bin/bash
# Add Docker's official GPG key:
sudo apt-get update
sudo apt-get install ca-certificates curl
sudo install -m 0755 -d /etc/apt/keyrings
sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc
sudo chmod a+r /etc/apt/keyrings/docker.asc

# Add the repository to Apt sources:
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \
  $(. /etc/os-release && echo "${UBUNTU_CODENAME:-$VERSION_CODENAME}") stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt-get update

sudo apt-get install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
sudo apt-get install -y nginx certbot python3-certbot-nginx
```
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –ø—Ä–æ–µ–∫—Ç–æ–º
```
cd autozakaz_bot
```
- –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø–æ –ø—Ä–∏–º–µ—Ä—É .env.example
```
cp .env.example .env
```
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã 
```
sudo docker compose up -d --build
```
- –í–æ–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Django —Å —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∞–¥–º–∏–Ω–∞ –∏–∑ —Ñ–∞–π–ª–∞ `.env`
```
http://your-domain.ru/admin
```
- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ `API_TOKEN` –≤ —Ñ–∞–π–ª–µ `.env`
```
https://your-domain.ru/admin/authtoken/tokenproxy/
```
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
```
sudo docker compose down && sudo docker compose up -d --build
```

### ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx <a id="nginx-config"></a>
- –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é nginx
```
sudo nano /etc/nginx/sites-available/autozakaz.conf
```
```
server {
    listen 80;
    server_name your-domain.ru;
    location / {
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_set_header Host $http_host;
            proxy_pass http://127.0.0.1:8080/;
    }
}
```
```
sudo ln -s /etc/nginx/sites-available/autozakaz.conf /etc/nginx/sites-enabled
```
- –ü–æ–ª—É—á–∏—Ç–µ ssl-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–ª—è –≤–∞—à–µ–≥–æ –¥–æ–º–µ–Ω–∞
```
sudo certbot --nginx -d your-domain.ru
```

### üì¶ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ <a id="usage"></a>
–í —Å–ª–µ–¥—É—é—â–∏—Ö —Ä–∞–∑–¥–µ–ª–∞—Ö –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –∫–∞–∫ –º–∏–Ω–∏–º—É–º –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç:
- –ò–º–ø–æ—Ä—Ç –ø—Ä–∞–π—Å–æ–≤ -> –ü—Ä–∞–π—Å—ã –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ - url-–ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –ø—Ä–∞–π—Å–∞
- –ò–º–ø–æ—Ä—Ç –ø—Ä–∞–π—Å–æ–≤ -> –ó–∞–¥–∞—á–∏ –∏–º–ø–æ—Ä—Ç–∞ - –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
- –û –ö–æ–º–ø–∞–Ω–∏–∏ -> –ö–æ–Ω—Ç–∞–∫—Ç—ã
- –û –ö–æ–º–ø–∞–Ω–∏–∏ -> –û—Ñ–µ—Ä—Ç–∞
- –û –ö–æ–º–ø–∞–Ω–∏–∏ -> –°–æ–≥–ª–∞—Å–∏—è –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ü–î

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é —Ç–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏ —Å –∫–∞—Ç–∞–ª–æ–≥–æ–º –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ https://your-domain.ru,
–∞ —Ç–∞–∫–∂–µ –≤ –±–æ—Ç–µ.
–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ—Å–µ—â–µ–Ω–∏–∏ –±–æ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –±—É–¥–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–æ –ø–æ–¥–≤–µ—Ä–¥–∏—Ç—å —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

### üë®‚Äçüíª –ê–≤—Ç–æ—Ä—ã <a id="authors"></a>
[–î–µ–Ω–∏—Å –¢—Ä–µ—Ç—å—è–∫–æ–≤](https://github.com/dentretyakoff)
